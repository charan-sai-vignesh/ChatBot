<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chatbot</title>
    <style>
        :root { --bg:#0f172a; --panel:#111827; --accent:#22d3ee; --muted:#9ca3af; --text:#e5e7eb; }
        * { box-sizing: border-box; }
        body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background: var(--bg); color: var(--text); }
        .wrap { max-width: 880px; margin: 0 auto; padding: 24px; }
        .card { background: var(--panel); border: 1px solid #1f2937; border-radius: 12px; overflow: hidden; }
        .header { padding: 16px 20px; border-bottom: 1px solid #1f2937; display:flex; align-items:center; gap:10px; }
        .dot { width:10px; height:10px; border-radius:50%; background: var(--accent); box-shadow: 0 0 12px var(--accent); }
        .title { font-weight: 600; letter-spacing: .2px; }
        .chat { height: 60vh; min-height: 360px; overflow-y: auto; padding: 16px; display:flex; flex-direction: column; gap: 12px; }
        .msg { max-width: 80%; padding: 10px 12px; border-radius: 10px; line-height: 1.45; word-wrap: break-word; white-space: pre-wrap; }
        .user { align-self: flex-end; background: #1f2937; border: 1px solid #2a3646; }
        .bot { align-self: flex-start; background: #0b2530; border: 1px solid #123341; }
        .meta { font-size: 12px; color: var(--muted); margin-bottom: 6px; }
        .inputbar { display:flex; gap:10px; padding: 16px; border-top: 1px solid #1f2937; background: #0b1220; }
        .inputbar input { flex:1; padding: 12px 14px; border-radius: 10px; border: 1px solid #1f2937; background: #0c1424; color: var(--text); outline: none; }
        .inputbar button { padding: 12px 16px; border-radius: 10px; border: 1px solid #123341; background: #0b2530; color: var(--text); cursor: pointer; }
        .inputbar button:hover { border-color: var(--accent); box-shadow: 0 0 0 2px rgba(34,211,238,.15) inset; }
        .hint { color: var(--muted); font-size: 12px; padding: 8px 20px 16px; }
        a { color: var(--accent); text-decoration: none; }
    </style>
    <script>
        function el(tag, cls, text) {
            const e = document.createElement(tag);
            if (cls) e.className = cls;
            if (text !== undefined) e.textContent = text;
            return e;
        }

        function addMessage(role, text) {
            const chat = document.getElementById('chat');
            const wrap = el('div');
            const meta = el('div', 'meta', role === 'user' ? 'You' : 'Bot');
            const bubble = el('div', `msg ${role}`);
            bubble.innerHTML = text;
            wrap.appendChild(meta);
            wrap.appendChild(bubble);
            chat.appendChild(wrap);
            chat.scrollTop = chat.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('input');
            const text = input.value.trim();
            if (!text) return;
            input.value = '';
            addMessage('user', text);
            try {
                const res = await fetch(`/predict`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: text })
                });
                const data = await res.json();
                addMessage('bot', data.answer ?? '');
            } catch (e) {
                addMessage('bot', 'Request failed. Is the server running on port 8000?');
            }
        }

        function init() {
            const input = document.getElementById('input');
            const btn = document.getElementById('send');
            btn.addEventListener('click', sendMessage);
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            addMessage('bot', 'Hi! Type a message or try commands: !movie, !wiki, !weather');
        }

        window.addEventListener('DOMContentLoaded', init);
    </script>
</head>
<body>
    <div class="wrap">
        <div class="card">
            <div class="header">
                <div class="dot"></div>
                <div class="title">Chatbot</div>
            </div>
            <div id="chat" class="chat"></div>
            <div class="inputbar">
                <input id="input" type="text" placeholder="Message..." />
                <button id="send">Send</button>
            </div>
        </div>
    </div>
</body>
</html>


